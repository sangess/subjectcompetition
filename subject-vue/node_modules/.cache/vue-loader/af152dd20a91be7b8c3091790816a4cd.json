{"remainingRequest":"D:\\IDEA_workspace2\\subject-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IDEA_workspace2\\subject-vue\\src\\views\\college\\college_project.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\IDEA_workspace2\\subject-vue\\src\\views\\college\\college_project.vue","mtime":1621104297422},{"path":"D:\\IDEA_workspace2\\subject-vue\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\IDEA_workspace2\\subject-vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\IDEA_workspace2\\subject-vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\IDEA_workspace2\\subject-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IDEA_workspace2\\subject-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#fenye {\n  text-align: center;\n}\n",{"version":3,"sources":["college_project.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiNA;AACA;AACA","file":"college_project.vue","sourceRoot":"src/views/college","sourcesContent":["<template>\r\n  <div id=\"college_project\">\r\n    <el-card >\r\n      <div slot=\"header\">\r\n        <el-row :gutter=\"10\">\r\n          <el-col :span=\"8\">\r\n            <span >项目列表</span>\r\n          </el-col>\r\n          <el-col :span=\"16\">\r\n            <el-button type=\"text\" style=\"float:right;\" @click=\"导出为Excel()\">导出为Excel</el-button>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n      <div>\r\n        <el-row :gutter=\"10\">\r\n          <el-form ref=\"searchProjects\" :model=\"searchProjects\" label-width=\"80px\">\r\n            <el-col :span=\"4\">\r\n              <el-form-item label=\"项目名称\" prop=\"name\">\r\n                <el-input v-model=\"searchProjects.projectName\"></el-input>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"4\">\r\n              <el-form-item label=\"所属竞赛\" prop=\"suoshujingsai\">\r\n                <el-select v-model=\"searchProjects.compId\" placeholder=\"所属竞赛\">\r\n                  <el-option v-for=\"item in allComp\"\r\n                             :key=\"item.id\"\r\n                             :label=\"item.compName\"\r\n                             :value=\"item.id\">\r\n                  </el-option>\r\n                  <el-option label=\"全部\" value></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"4\">\r\n              <el-form-item label=\"审核状态\" prop=\"zhuangtai\">\r\n                <el-select v-model=\"searchProjects.applyState\" placeholder=\"请选择项目状态\">\r\n                  <el-option label=\"未审核\" value=0></el-option>\r\n                  <el-option label=\"审核通过\" value=1></el-option>\r\n                  <el-option label=\"审核驳回\" value=2></el-option>\r\n                  <el-option label=\"全部\" value></el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"3\">\r\n              <el-button\r\n                      type=\"primary\"\r\n                      size=\"medium\"\r\n                      icon=\"el-icon-search\"\r\n                      style=\"float: right;\"\r\n                      @click=\"findProjectInCollege()\"\r\n              >筛选 / 查询</el-button>\r\n            </el-col>\r\n            <el-col :span=\"4\">\r\n              <el-button\r\n                      type=\"primary\"\r\n                      size=\"medium\"\r\n                      icon=\"el-icon-search\"\r\n                      style=\"float: right;\"\r\n                      @click=\"checkAll()\"\r\n              >查看全部</el-button>\r\n            </el-col>\r\n          </el-form>\r\n        </el-row>\r\n      </div>\r\n      <div>\r\n        <el-table\r\n          id=\"竞赛项目列表\"\r\n          class=\"elTable\"\r\n          :data=\"collegeProjectData.slice((currentPage-1)*pagesize,currentPage*pagesize)\"\r\n          stripe\r\n          border\r\n          height=\"500px\"\r\n          style=\"width: 100%\"\r\n          :default-sort = \"{prop: 'date', order: 'descending'}\"\r\n        >\r\n          <el-table-column align=\"center\"  label=\"项目编号\" width=\"80px\" sortable>\r\n            <template slot-scope=\"scope\">\r\n              {{scope.$index + 1}}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\"  label=\"项目名称\" sortable>\r\n            <template slot-scope=\"scope\">\r\n              <el-tooltip class=\"item\" effect=\"dark\" size=\"mini\" content=\"点击查看项目信息\" placement=\"top-end\">\r\n                <el-button type=\"text\" @click=\"showProjectInfo(scope.row.id)\">{{scope.row.projectName}}</el-button>\r\n              </el-tooltip>\r\n            </template>\r\n          </el-table-column >\r\n          <el-table-column align=\"center\" prop=\"comp.compName\" label=\"所属竞赛\" sortable></el-table-column>\r\n          <el-table-column align=\"center\" prop=\"comp.compState\" label=\"所属竞赛状态\" sortable>\r\n            <template slot-scope=\"scope\">\r\n              <el-tag  effect=\"dark\"\r\n                       :type=\"scope.row.comp.compState === 0 ? 'info' :       /*规划中*/\r\n              (scope.row.comp.compState === 1 ? 'primary':       /*可报名*/\r\n              (scope.row.comp.compState === 2 ? 'success':       /*备赛中*/\r\n              (scope.row.comp.compState === 3 ? 'warning':       /*比赛中*/\r\n              'danger')))\"\r\n                       disable-transitions\r\n              >\r\n                <span v-if=\"scope.row.comp.compState==0\">规划中</span>\r\n                <span v-if=\"scope.row.comp.compState==1\">报名中</span>\r\n                <span v-if=\"scope.row.comp.compState==2\">备赛中</span>\r\n                <span v-if=\"scope.row.comp.compState==3\">比赛中</span>\r\n                <span v-if=\"scope.row.comp.compState==4\">已结束</span>\r\n              </el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\"  label=\"指导老师\" width=\"120px\" sortable><!--prop=\"createByTeacher.nickName\"-->\r\n            <template slot-scope=\"scope\">\r\n              <span>{{scope.row.createByTeacher.nickname}}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" prop=\"pay\" label=\"预算\" sortable></el-table-column>\r\n          <el-table-column align=\"center\" prop=\"applyState\" label=\"状态\" sortable>\r\n            <template slot-scope=\"scope\">\r\n              <el-tag v-if=\"scope.row.applyState == 0\" type=\"danger\" disable-transitions>审核未通过</el-tag>\r\n              <el-tag v-if=\"scope.row.applyState == 1\" :type=\"scope.row.applyState === 1 ? 'success' : 'warning'\" disable-transitions>已审核</el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"操作\" width=\"115px\">\r\n            <template slot-scope=\"scope\">\r\n<!--              <el-button\r\n                v-if=\"scope.row.applyState == 0\"\r\n                size=\"mini\"\r\n                type=\"warning\"\r\n                @click=\"删除审核未通过项目(scope.row)\"\r\n              >删除</el-button>-->\r\n              <el-button\r\n                v-if=\"scope.row.applyState == 1\"\r\n                size=\"mini\"\r\n                type=\"primary\"\r\n                @click=\"getProjectJoinPersons(scope.row)\"\r\n              >人员查看</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <div id=\"fenye\">\r\n          <!-- 设置layout，表示需要显示的内容，用逗号分隔，布局元素会依次显示。\r\n            prev表示上一页，next为下一页，pager表示页码列表，\r\n            除此以外还提供了jumper和total，size和特殊的布局符号->，->后的元素会靠右显示，\r\n            jumper表示跳页元素，\r\n            total表示总条目数，\r\n            page-size  每页多少条数据\r\n            @current-change=\"current_change\" //currentPage改变时会触发\r\n          size用于设置每页显示的页码数量。-->\r\n          <el-pagination\r\n                  background\r\n                  layout=\"prev, pager, next\"\r\n                  :total=\"collegeProjectData.length\"\r\n                  :page-size=\"12\"\r\n                  @current-change=\"current_change\"\r\n                  :current-page.sync=\"currentPage\"\r\n          ></el-pagination>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n    <!-- 学生列表模态框 -->\r\n    <el-dialog title=\"项目成员\" :visible.sync=\"projectPersonInfo\">\r\n      <el-table :data=\"projectJoinTeacher\">\r\n        <el-table-column property=\"nickname\" label=\"教师姓名\"></el-table-column>\r\n        <el-table-column property=\"username\" label=\"用户名\"></el-table-column>\r\n        <el-table-column property=\"college.nickname\" label=\"所属院系\"></el-table-column>\r\n        <el-table-column label=\"身份\">\r\n          <template slot-scope=\"scope\">\r\n            <span v-if=\"scope.row.id==createProjectTeacherId\">\r\n              <el-tag type=\"success\">带队老师</el-tag>\r\n            </span>\r\n            <span v-if=\"scope.row.id!=createProjectTeacherId\">\r\n              指导老师\r\n            </span>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <el-table :data=\"projectJoinStudent\">\r\n        <el-table-column property=\"nickname\" label=\"学生姓名\"></el-table-column>\r\n        <el-table-column property=\"username\" label=\"学号\"></el-table-column>\r\n        <el-table-column property=\"college.nickname\" label=\"所属院系\"></el-table-column>\r\n        <el-table-column label=\"身份\">参赛学员</el-table-column>\r\n      </el-table>\r\n    </el-dialog>\r\n    <!-- 竞赛项目展示模态框 -->\r\n    <el-dialog title=\"项目信息\" :visible.sync=\"projectVisible\" width=\"70%\">\r\n      <el-table  stripe border :data=\"projectInfo\" >\r\n        <el-table-column align=\"center\" label=\"项目编号\" prop=\"id\" ></el-table-column>\r\n        <el-table-column align=\"center\" prop=\"projectName\" label=\"项目名称\"></el-table-column>\r\n        <el-table-column align=\"center\" prop=\"comp.compName\" label=\"所属竞赛\"></el-table-column>\r\n        <el-table-column align=\"center\" label=\"参与学生人数\" >\r\n          <template slot-scope=\"scope\">\r\n            <span v-if=\"scope.row.countStudent<scope.row.comp.maxCountStudent\">{{scope.row.countStudent}}人</span>\r\n            <span v-if=\"scope.row.countStudent>=scope.row.comp.maxCountStudent\">{{scope.row.countStudent}}人(满员)</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column align=\"center\" label=\"参与教师人数\" >\r\n          <template slot-scope=\"scope\">\r\n            <span v-if=\"scope.row.countTeacher<scope.row.comp.maxCountTeacher\">{{scope.row.countTeacher}}人</span>\r\n            <span v-if=\"scope.row.countTeacher>=scope.row.comp.maxCountTeacher\">{{scope.row.countTeacher}}人(满员)</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column align=\"center\" prop=\"createByTeacher.nickname\" label=\"指导老师\" ></el-table-column>\r\n        <el-table-column align=\"center\" prop=\"createByTeacher.username\" label=\"指导老师用户名\" ></el-table-column>\r\n        <el-table-column align=\"center\" label=\"预算\">\r\n          <template slot-scope=\"scope\">\r\n            <span>{{scope.row.pay}}元</span>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<style>\r\n  #fenye {\r\n    text-align: center;\r\n  }\r\n</style>\r\n<script>\r\nimport { exportExcel } from \"../../assets/js/utils.js\";\r\nimport api from '../../main.js'\r\nexport default {\r\n  inject:['reload'],\r\n  name: \"college_project\",\r\n  data() {\r\n    return {\r\n      collegeId:\"\",\r\n      allComp:[],\r\n      pagesize: 12,\r\n      createProjectTeacherId:\"\",\r\n      projectVisible:false,\r\n      currentPage: 1,\r\n      projectPersonInfo: false,\r\n      projectInfo:[],\r\n      studentData: [],\r\n      collegeProjectData: [],\r\n      projectJoinStudent:[],\r\n      projectJoinTeacher:[],\r\n      searchProjects: {\r\n        projectName:\"\",\r\n        compId:\"\",\r\n        applyState:\"\",\r\n      }\r\n    };\r\n  },\r\n  mounted() {\r\n    this.collegeId=this.$store.state.id;\r\n    this.getAllComp();\r\n    this.getCollegeProjectData();\r\n  },\r\n  methods: {\r\n    getAllComp(){\r\n      let that=this;\r\n      that.$axios\r\n        .post(api+`/comp/getAllComps`)\r\n        .then(function (response) {\r\n          that.allComp=response.data;\r\n        })\r\n    },\r\n    /**\r\n     * 得到院系所有的项目\r\n     */\r\n    getCollegeProjectData() {\r\n      let that = this;\r\n      let collegeId=that.$store.state.id;\r\n      this.$axios\r\n        .get(api+`/college/getProjectByCollege/`+collegeId)\r\n        .then(function(response) {\r\n          that.collegeProjectData = response.data;\r\n        })\r\n        .catch(function(error) {\r\n          console.error(error);\r\n        });\r\n    },\r\n    checkAll(){\r\n      let that=this;\r\n      that.reload();\r\n    },\r\n    findProjectInCollege() {\r\n      let that = this;\r\n      let searchForm=new FormData();\r\n      searchForm.append(\"projectName\",that.searchProjects.projectName);\r\n      searchForm.append(\"comp.id\",that.searchProjects.compId);\r\n      searchForm.append(\"applyState\",that.searchProjects.applyState);\r\n      searchForm.append(\"collegeId\",that.collegeId);\r\n      this.$axios\r\n      .post(api+`/project/getMoreSearchProjectByCollege`,searchForm)\r\n      .then(function(response) {\r\n        that.collegeProjectData = response.data;\r\n      })\r\n      .catch(function(error) {\r\n        that.$message.error(\"系统错误，操作失败，请稍后再试!\");\r\n      });\r\n    },\r\n    导出为Excel() {\r\n      let excelname = this.$store.state.nickname + \"竞赛项目\";\r\n      exportExcel(\"竞赛项目列表\", excelname);\r\n    },\r\n    /**\r\n     * 点击打开显示项目参与人员\r\n     * */\r\n    getProjectJoinPersons(project){\r\n      let projectId=project.id;\r\n      this.createProjectTeacherId=project.createByTeacher.id;\r\n      this.projectPersonInfo=true;\r\n      this.getProjectJoinTeacher(projectId);\r\n      this.getProjectJoinStudent(projectId);\r\n    },\r\n    /**\r\n     * 得到参赛的老师\r\n     * @param projectId\r\n     */\r\n    getProjectJoinTeacher(projectId){\r\n      let that=this;\r\n      that.$axios\r\n        .get(api+`/project/getProjectJoinTeacher/`+projectId)\r\n        .then(function (response) {\r\n          that.projectJoinTeacher=response.data;\r\n        })\r\n    },\r\n    /**\r\n     * 得到参赛的学生\r\n     * @param projectId\r\n     */\r\n    getProjectJoinStudent(projectId){\r\n      let that=this;\r\n      that.$axios\r\n      .get(api+`/project/getProjectJoinStudent/`+projectId)\r\n      .then(function (response) {\r\n        that.projectJoinStudent=response.data;\r\n      })\r\n    },\r\n    showProjectInfo(projectId){\r\n      let that=this;\r\n      that.projectVisible=true;\r\n      that.$axios\r\n      .get(api+`/teacher/getProjectById/`+projectId)\r\n      .then(function (response) {\r\n        let newArray=[];\r\n        newArray.push(response.data);\r\n        that.projectInfo=newArray;\r\n      })\r\n\r\n    },\r\n    current_change(currentPage) {\r\n      //改变当前页\r\n      this.currentPage = currentPage;\r\n    },\r\n  }\r\n};\r\n</script>"]}]}